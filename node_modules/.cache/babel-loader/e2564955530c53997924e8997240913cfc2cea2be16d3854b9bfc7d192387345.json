{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport SubjectDetailComponent from \"@/components/subject/SubjectDetailComponent.vue\";\nimport axios from \"axios\";\nexport default {\n  components: {\n    SubjectDetailComponent\n  },\n  provide() {\n    return {\n      getSubjectData: () => this.subjectData // subjectData를 함수로 제공\n    };\n  },\n  data() {\n    return {\n      user: {},\n      subjectData: null,\n      // 초기 상태는 null\n\n      subjectId: \"\",\n      selectedMenu: \"SubjectDetail\",\n      // 기본으로 선택된 메뉴\n      lecture: {\n        lectureList: [],\n        page: {\n          pageSize: 5,\n          currentPage: 0\n        }\n      }\n    };\n  },\n  async created() {\n    this.subjectId = this.$route.params.id;\n    try {\n      await this.$store.dispatch(\"setUserAllInfoActions\");\n      this.user = this.$store.getters.getUserObj;\n    } catch (error) {\n      console.error(\"사용자 정보를 가져오는 중 오류가 발생했습니다:\", error);\n    }\n    this.getSubjectPerLectureList();\n  },\n  watch: {\n    subjectData: {\n      deep: true,\n      handler(newVal) {\n        console.log(\"Subject Data Updated:\", newVal);\n      }\n    }\n  },\n  methods: {\n    async getSubjectPerLectureList() {\n      const params = {\n        size: this.lecture.page.pageSize,\n        page: this.lecture.page.currentPage\n      };\n      const response = await axios.get(`${process.env.VUE_APP_API_BASE_URL}/subject/${this.subjectId}/lecture/list`, {\n        params\n      });\n      const additionalData = response.data.result.content;\n      console.log(response);\n      this.lecture.lectureList = [...this.lecture.lectureList, ...additionalData];\n    },\n    setLectureCreateBtn() {\n      console.log(this.user);\n      console.log(this.user.userId, this.subjectData.userTeacherId);\n      if (Number(this.user.userId) === this.subjectData.userTeacherId || this.user.role == \"ADMIN\") {\n        console.log(\"수정 가능!!\");\n        this.user.isAdmin = true;\n      } else {\n        console.log(\"수정 불가!\");\n        this.user.isAdmin = false;\n      }\n    },\n    handleSubjectDataLoaded(data) {\n      this.subjectData = data;\n      // 여기에 추가 작업을 작성하면 됩니다.\n      if (this.subjectData && this.user.userId) {\n        this.setLectureCreateBtn();\n      }\n    },\n    handleMenuUpdate(newSelection) {\n      this.selectedMenu = newSelection;\n      console.log(\"메뉴 바뀜 >> \", newSelection);\n    },\n    goToDetail(lectureId) {\n      this.$router.push({\n        name: \"LectureDetail\",\n        params: {\n          id: lectureId\n        }\n      });\n    }\n  },\n  computed: {\n    isAdmin() {\n      return this.user.isAdmin;\n    }\n  }\n};","map":{"version":3,"names":["SubjectDetailComponent","axios","components","provide","getSubjectData","subjectData","data","user","subjectId","selectedMenu","lecture","lectureList","page","pageSize","currentPage","created","$route","params","id","$store","dispatch","getters","getUserObj","error","console","getSubjectPerLectureList","watch","deep","handler","newVal","log","methods","size","response","get","process","env","VUE_APP_API_BASE_URL","additionalData","result","content","setLectureCreateBtn","userId","userTeacherId","Number","role","isAdmin","handleSubjectDataLoaded","handleMenuUpdate","newSelection","goToDetail","lectureId","$router","push","name","computed"],"sources":["/Users/milcho/Project/TEENKIRI/teenkiri_front/teenkiri_front/src/views/subject/SubjectDetail.vue"],"sourcesContent":["<template>\n  <v-app>\n    <v-container>\n      <!-- subjectData가 로드된 후에만 컴포넌트를 렌더링 -->\n      <SubjectDetailComponent\n        @subject-data-loaded=\"handleSubjectDataLoaded\"\n        v-model=\"selectedMenu\"\n      />\n      <!-- <SubjectDetailComponent  /> -->\n\n      <div class=\"btnWrap\" v-if=\"this.user.isAdmin\">\n        <v-col>\n          <router-link :to=\"`/lecture/create/${subjectId}`\">\n            <v-btn class=\"btn_write\">강의 업로드하기</v-btn>\n          </router-link>\n        </v-col>\n      </div>\n\n      <!-- 강의 목록에 해당하는 내용 -->\n      <!-- 강의 목록 -->\n      <table class=\"tbl_list\">\n        <caption></caption>\n        <colgroup>\n          <col width=\"80\" />\n          <col width=\"\" />\n          <col width=\"140\" />\n          <col :width=\"isAdmin ? '180' : '280'\" /> <!-- 수강여부 열의 너비를 관리자가 아닐 때 넓힘 -->\n          <col v-if=\"isAdmin\" width=\"100\" /> <!-- 관리 열 -->\n        </colgroup>\n        <thead>\n          <tr>\n            <th>번호</th>\n            <th>제목</th>\n            <th class=\"text-center\">수강여부</th>\n            <th>강의시간</th>\n            <th>이동</th>\n            <th v-if=\"this.user.isAdmin\">관리</th> <!-- 관리 버튼 헤더 -->\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-if=\"lecture.lectureList.length === 0\">\n            <td :colspan=\"isAdmin ? 6 : 5\" class=\"text_center\">강의가 없습니다.</td>\n          </tr>\n          <tr v-for=\"(item, index) in lecture.lectureList\" :key=\"item.id\">\n            <td>{{ index + 1 }}</td>\n            <td class=\"text_left\">{{ item.title }}</td>\n            <td class=\"text-center\">\n              <div class=\"py-2\">\n                    <div v-if=\"item.progress\">{{ item.progress }} %</div>\n                    <div>\n                      <v-chip v-if=\"item.isCompleted\" color=\"primary\">\n                        수강완료\n                      </v-chip>\n                      <v-chip v-if=\"item.isCompleted === false\" color=\"green\">\n                        수강 중\n                      </v-chip>\n                      <v-chip\n                        v-if=\"item.isCompleted === null\"\n                        color=\"secondary\"\n                      >\n                        시청 전\n                      </v-chip>\n                    </div>\n                  </div>\n            </td>\n            <td>{{ item.videoDuration }}</td>\n            <td>\n              <a v-if=\"user.userId\" href=\"javascript:void(0)\" class=\"btn_write\" @click=\"goToDetail(item.id)\">강의보기</a>\n            </td>\n            <td v-if=\"this.user.isAdmin\">\n              <a href=\"javascript:void(0)\" class=\"btn_write\" :to=\"`/lecture/edit/${item.id}`\">수정</a>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </v-container>\n  </v-app>\n</template>\n\n<script>\nimport SubjectDetailComponent from \"@/components/subject/SubjectDetailComponent.vue\";\nimport axios from \"axios\";\n\nexport default {\n  components: {\n    SubjectDetailComponent,\n  },\n  provide() {\n    return {\n      getSubjectData: () => this.subjectData, // subjectData를 함수로 제공\n    };\n  },\n  data() {\n    return {\n      user: {},\n\n      subjectData: null, // 초기 상태는 null\n\n      subjectId: \"\",\n      selectedMenu: \"SubjectDetail\", // 기본으로 선택된 메뉴\n      lecture: {\n        lectureList: [],\n        page: {\n          pageSize: 5,\n          currentPage: 0,\n        },\n      },\n    };\n  },\n  async created() {\n    this.subjectId = this.$route.params.id;\n    try {\n      await this.$store.dispatch(\"setUserAllInfoActions\");\n      this.user = this.$store.getters.getUserObj;\n    } catch (error) {\n      console.error(\"사용자 정보를 가져오는 중 오류가 발생했습니다:\", error);\n    }\n    this.getSubjectPerLectureList();\n  },\n  watch: {\n    subjectData: {\n      deep: true,\n      handler(newVal) {\n        console.log(\"Subject Data Updated:\", newVal);\n      },\n    },\n  },\n  methods: {\n    async getSubjectPerLectureList() {\n      const params = {\n        size: this.lecture.page.pageSize,\n        page: this.lecture.page.currentPage,\n      };\n\n      const response = await axios.get(\n        `${process.env.VUE_APP_API_BASE_URL}/subject/${this.subjectId}/lecture/list`,\n        { params }\n      );\n      const additionalData = response.data.result.content;\n      console.log(response);\n      this.lecture.lectureList = [\n        ...this.lecture.lectureList,\n        ...additionalData,\n      ];\n    },\n    setLectureCreateBtn() {\n      console.log(this.user);\n      console.log(this.user.userId, this.subjectData.userTeacherId);\n      if (Number(this.user.userId) === this.subjectData.userTeacherId || this.user.role == \"ADMIN\") {\n        console.log(\"수정 가능!!\");\n        this.user.isAdmin = true;\n      } else {\n        console.log(\"수정 불가!\");\n        this.user.isAdmin = false;\n      }\n    },\n    handleSubjectDataLoaded(data) {\n      this.subjectData = data;\n      // 여기에 추가 작업을 작성하면 됩니다.\n      if(this.subjectData && this.user.userId){\n        this.setLectureCreateBtn();\n      }\n    },\n    handleMenuUpdate(newSelection) {\n      this.selectedMenu = newSelection;\n      console.log(\"메뉴 바뀜 >> \", newSelection);\n    },\n    goToDetail(lectureId) {\n      this.$router.push({ name: \"LectureDetail\", params: { id: lectureId } });\n    },\n  },\n  computed: {\n    isAdmin() {\n      return this.user.isAdmin;\n    },\n  },\n};\n</script>\n\n<style scoped>\n.container {\n  padding-top: 20px;\n}\n\n.btnWrap {\n  text-align: right;\n  margin-bottom: 20px;\n}\n\n.btn_write {\n  background-color:   #f27885;\n  color: #fff;\n  padding: 10px 20px;\n  text-decoration: none;\n  border-radius: 5px;\n  font-size: 16px;\n  display: inline-block;\n  transition: background-color 0.3s ease;\n}\n\n\n\n.tbl_list {\n  width: 100%;\n  border-collapse: collapse;\n  margin-bottom: 20px;\n}\n\n.tbl_list th,\n.tbl_list td {\n  border-top: 1px solid #ddd;\n  border-bottom: 1px solid #ddd;\n  padding: 10px;\n  text-align: left;\n  border-left: none;\n  border-right: none;\n}\n\n.tbl_list th {\n  background-color: #f4f4f4;\n  font-weight: bold;\n}\n\n.text_left {\n  text-align: left;\n}\n\n.text_center {\n  text-align: center;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}