{"ast":null,"code":"// import VideoPlayer from '@/components/Lecture/videoPlayer.vue';\nimport axios from \"axios\";\nimport videojs from \"video.js\";\nimport 'video.js/dist/video-js.min.css';\nexport default {\n  // name: 'VideoExample',\n  name: \"VideoPlayer\",\n  // components: {\n  //   VideoPlayer\n  // },\n  data() {\n    return {\n      user: {\n        token: \"\",\n        id: \"\",\n        email: \"\"\n      },\n      lectureId: \"\",\n      lectureData: {},\n      // 영상 진행률 체크를 위한 코드\n      isVideoPlay: false,\n      currentVideoTime: 0,\n      mostWatchedTime: 0,\n      userProgress: 0,\n      // 유저 진행률 표시용\n\n      player: null,\n      videoOptions: {\n        autoplay: true,\n        controls: true,\n        sources: [{\n          src: \"\",\n          type: \"video/mp4\"\n        }]\n      },\n      // 인터벌 ID를 저장할 변수\n      checkInterval: null,\n      updateUserProgressInterval: null\n    };\n  },\n  async created() {\n    try {\n      await this.$store.dispatch(\"setUserAllInfoActions\");\n      this.user = this.$store.getters.getUserObj;\n      if (this.user.token === \"\") {\n        alert(\"로그인이 필요합니다.\");\n        history.go(-1);\n      }\n      this.lectureId = this.$route.params.id;\n\n      // 강의 세부 정보를 가져옵니다.\n      await this.getLectureDetail();\n\n      // 강의 세부 정보에서 비디오 URL을 설정하고 VideoPlayer 컴포넌트를 렌더링합니다.\n      this.setLectureDetail();\n    } catch (error) {\n      console.error(\"An error occurred while fetching user info:\", error);\n    }\n  },\n  mounted() {\n    // player를 초기화합니다.\n    this.initPlayer();\n    window.addEventListener(\"keyupEvent\", this.handleKeydown);\n  },\n  watch: {\n    \"videoOptions.sources\": {\n      handler(newSources) {\n        const newSrc = newSources[0].src;\n        if (newSrc) {\n          if (this.player) {\n            this.player.src(newSrc);\n          } else {\n            this.initPlayer();\n          }\n        }\n      },\n      deep: true // 깊은 변경 감지\n    }\n  },\n  methods: {\n    async getLectureDetail() {\n      console.log(\"강의 불러오기\");\n      try {\n        const response = await axios.get(`${process.env.VUE_APP_API_BASE_URL}/user/lecture/detail/${this.lectureId}`);\n        const additionalData = response.data.result;\n        this.lectureData = additionalData;\n\n        // 시간용 변수 적용\n        this.mostWatchedTime = this.lectureData.userLectureDuration;\n        if (this.lectureData.isCompleted) {\n          this.currentVideoTime = 0; //이미 시청이 완료된 경우는처음부터 다시 시청\n        } else {\n          this.currentVideoTime = this.lectureData.userLectureDuration;\n        }\n        this.updateUserProgress(); // 유저 표시용도의 퍼센트 계산\n\n        // lectureData에서 videoUrl을 가져와 videoOptions를 업데이트합니다.\n        this.videoOptions.sources[0].src = this.lectureData.videoUrl;\n      } catch (e) {\n        if (e.response.data.status_code === 404) {\n          alert(\"수강신청이 되지 않았습니다.\");\n          history.go(-1);\n        } else {\n          console.error(e);\n        }\n      }\n    },\n    setLectureDetail() {\n      // videoOptions가 업데이트된 후 loadVideo를 true로 설정하여 VideoPlayer를 렌더링합니다.\n      this.loadVideo = true;\n    },\n    initPlayer() {\n      if (this.videoOptions.sources[0].src) {\n        this.player = videojs(this.$refs.videoPlayer, this.videoOptions, () => {\n          // 영상 시작 시간을 설정하는 이벤트\n          this.player.on(\"loadstart\", () => {\n            this.setStartTime();\n          });\n\n          // 영상이 시작될 때\n          this.player.on(\"play\", () => {\n            this.onVideoPlay();\n          });\n\n          // 영상이 일시정지될 때\n          this.player.on(\"pause\", () => {\n            this.onVideoPause();\n          });\n\n          // 영상이 끝날 때\n          this.player.on(\"ended\", () => {\n            this.onVideoEnded();\n          });\n        });\n      }\n    },\n    setStartTime() {\n      // 영상의 시작 시간을 설정\n      this.player.currentTime(this.currentVideoTime);\n      console.log(\"영상의 시작 시간이 설정되었습니다.\");\n    },\n    onVideoPlay() {\n      console.log(\"영상이 시작되었습니다.\");\n      if (!this.lectureData.isCompleted) {\n        //시청 완료가 false인 경우만 check 시작\n        this.checkInterval = setInterval(() => {\n          // 3초마다 플레이된 시간 체크 시작\n          this.checkPlayTime();\n        }, 3000);\n        this.updateUserProgressInterval = setInterval(() => {\n          this.updateUserProgress();\n        }, 1000);\n      }\n    },\n    onVideoPause() {\n      console.log(\"영상이 일시정지되었습니다.\");\n      // 3초마다 플레이된 시간 체크 중지\n      if (this.checkInterval) {\n        clearInterval(this.checkInterval);\n        this.checkInterval = null;\n      }\n\n      // 퍼센트 계산하던 것 체크 중지\n      if (this.updateUserProgressInterval) {\n        clearInterval(this.updateUserProgressInterval);\n        this.updateUserProgressInterval = null;\n      }\n    },\n    onVideoEnded() {\n      console.log(\"영상이 끝났습니다.\");\n      if (!this.lectureData.isCompleted) {\n        //기존에 시청완료가 되지 않았던 것만 보냄\n        this.currentVideoTime = this.lectureData.videoDuration;\n        this.updateUserProgress(); //완료된 것을 통해 100%로 다시 진행률 업데이트\n        this.postUserVideoEndedStatus(); // 비디오 끝 함수 호츨\n      }\n      clearInterval(this.checkInterval); // 영상이 끝나면 인터벌을 정리합니다.\n      clearInterval(this.updateUserProgressInterval); // 영상이 끝나면 인터벌을 정리합니다.\n    },\n    checkPlayTime() {\n      this.currentVideoTime = Math.floor(this.player.currentTime()); // 소수점 내림으로 고정. (비디오 전체시간때문에!)\n      this.postUserDurationVideoTime();\n      console.log(\"현재 플레이된 시간: \", this.currentVideoTime, \"초\");\n    },\n    updateUserProgress() {\n      let progressTime = this.currentVideoTime;\n      if (this.currentVideoTime <= this.mostWatchedTime) {\n        progressTime = this.mostWatchedTime;\n      }\n      const percentage = progressTime / this.lectureData.videoDuration * 100; //현재 시간을 기준으로 퍼센트 계산\n      let roundPercent = Math.round(percentage * 10) / 10; // 소수점 첫 번째 자리까지만 존재하도록 반올림\n      roundPercent = roundPercent >= 100 && !this.lectureData.isCompleted ? 99 : roundPercent >= 100 ? 100 : roundPercent; // isCompleted true 여야 100\n      this.userProgress = roundPercent;\n    },\n    async postUserDurationVideoTime() {\n      if (this.currentVideoTime >= this.mostWatchedTime) {\n        try {\n          const userLectureDuration = {\n            userLectureDuration: this.currentVideoTime\n          };\n          const response = await axios.patch(`${process.env.VUE_APP_API_BASE_URL}/enroll/update/duration/${this.lectureData.enrollmentId}`, userLectureDuration);\n          console.log(\"update response:\", response); // error 해결용 log 추가\n        } catch (e) {\n          if (e.response.data.status_code === 404) {\n            alert(e.response.data.status_code.e.response.data.status_message);\n            history.go(-1);\n          } else {\n            alert(e.response.data.status_code.e.response.data.status_message);\n            console.error(e);\n          }\n        }\n      }\n    },\n    async postUserVideoEndedStatus() {\n      if (this.currentVideoTime > this.lectureData.videoDuration) {\n        this.currentVideoTime = this.lectureData.videoDuration; // 더 큰값이 들어가면 초기화\n      }\n      try {\n        const isCompleted = {\n          isCompleted: true\n        };\n        const response = await axios.patch(`${process.env.VUE_APP_API_BASE_URL}/enroll/update/complete/${this.lectureData.enrollmentId}`, isCompleted);\n        console.log(\"update response:\", response); // error 해결용 log 추가\n        this.lectureData.isCompleted = true;\n        this.updateUserProgress();\n      } catch (e) {\n        if (e.response.data.status_code === 404) {\n          alert(e.response.data.status_code.e.response.data.status_message);\n          history.go(-1);\n        } else {\n          alert(e.response.data.status_code.e.response.data.status_message);\n          console.error(e);\n        }\n      }\n    },\n    keyupEvent(event) {\n      // 오른쪽 방향키 (Key code: 39)\n      if (event.key === 'ArrowRight') {\n        this.skip(5);\n      }\n\n      // 왼쪽 방향키 (Key code: 37)\n      else if (event.key === 'ArrowLeft') {\n        this.skip(-5);\n      }\n\n      // 스페이스바 (Key code: 32)\n      else if (event.key === ' ') {\n        if (this.player.paused()) {\n          this.player.play();\n        } else {\n          this.player.pause();\n        }\n      }\n    },\n    skip(seconds) {\n      let currentTime = this.player.currentTime();\n      let newTime = currentTime + seconds;\n      if (newTime < 0) newTime = 0;\n      if (newTime > this.player.duration()) newTime = this.player.duration();\n      this.player.currentTime(newTime);\n    }\n  },\n  beforeUnmount() {\n    if (this.player) {\n      this.player.dispose();\n    }\n    if (this.checkInterval) {\n      clearInterval(this.checkInterval);\n    }\n    if (this.updateUserProgressInterval) {\n      clearInterval(this.updateUserProgressInterval);\n    }\n    window.removeEventListener(\"keyupEvent\", this.handleKeydown);\n  }\n};","map":{"version":3,"names":["axios","videojs","name","data","user","token","id","email","lectureId","lectureData","isVideoPlay","currentVideoTime","mostWatchedTime","userProgress","player","videoOptions","autoplay","controls","sources","src","type","checkInterval","updateUserProgressInterval","created","$store","dispatch","getters","getUserObj","alert","history","go","$route","params","getLectureDetail","setLectureDetail","error","console","mounted","initPlayer","window","addEventListener","handleKeydown","watch","handler","newSources","newSrc","deep","methods","log","response","get","process","env","VUE_APP_API_BASE_URL","additionalData","result","userLectureDuration","isCompleted","updateUserProgress","videoUrl","e","status_code","loadVideo","$refs","videoPlayer","on","setStartTime","onVideoPlay","onVideoPause","onVideoEnded","currentTime","setInterval","checkPlayTime","clearInterval","videoDuration","postUserVideoEndedStatus","Math","floor","postUserDurationVideoTime","progressTime","percentage","roundPercent","round","patch","enrollmentId","status_message","keyupEvent","event","key","skip","paused","play","pause","seconds","newTime","duration","beforeUnmount","dispose","removeEventListener"],"sources":["/Users/milcho/Project/TEENKIRI/teenkiri_front/teenkiri_front/src/views/lecture/LectureDetail.vue"],"sourcesContent":["<template>\n  <v-container>\n    <div class=\"mt-5\">\n      <h1>{{ lectureData.title }}</h1>\n      <div>\n        <v-progress-linear v-model=\"userProgress\" color=\"amber\" height=\"25\">\n          <template v-slot:default>\n            <strong> 진행률 {{ userProgress }}%</strong>\n          </template>\n        </v-progress-linear>\n      </div>\n      <div class=\"d-flex justify-center mt-5\" @keydown=\"keyupEvent\" tabindex=\"0\">\n        <video\n          ref=\"videoPlayer\"\n          class=\"video-js vjs-theme-city vjs-16-9 vjs-big-play-centered\"\n        ></video>\n      </div>\n    </div>\n  </v-container>\n</template>\n\n<script>\n// import VideoPlayer from '@/components/Lecture/videoPlayer.vue';\nimport axios from \"axios\";\nimport videojs from \"video.js\";\nimport 'video.js/dist/video-js.min.css';\n\nexport default {\n  // name: 'VideoExample',\n  name: \"VideoPlayer\",\n  // components: {\n  //   VideoPlayer\n  // },\n  data() {\n    return {\n      user: {\n        token: \"\",\n        id: \"\",\n        email: \"\",\n      },\n      lectureId: \"\",\n      lectureData: {},\n\n      // 영상 진행률 체크를 위한 코드\n      isVideoPlay: false,\n      currentVideoTime: 0,\n      mostWatchedTime: 0,\n      userProgress: 0, // 유저 진행률 표시용\n\n      player: null,\n\n      videoOptions: {\n        autoplay: true,\n        controls: true,\n        sources: [\n          {\n            src: \"\",\n            type: \"video/mp4\",\n          },\n        ],\n      },\n\n      // 인터벌 ID를 저장할 변수\n      checkInterval: null,\n      updateUserProgressInterval: null,\n    };\n  },\n  async created() {\n    try {\n      await this.$store.dispatch(\"setUserAllInfoActions\");\n      this.user = this.$store.getters.getUserObj;\n\n      if (this.user.token === \"\") {\n        alert(\"로그인이 필요합니다.\");\n        history.go(-1);\n      }\n\n      this.lectureId = this.$route.params.id;\n\n      // 강의 세부 정보를 가져옵니다.\n      await this.getLectureDetail();\n\n      // 강의 세부 정보에서 비디오 URL을 설정하고 VideoPlayer 컴포넌트를 렌더링합니다.\n      this.setLectureDetail();\n    } catch (error) {\n      console.error(\"An error occurred while fetching user info:\", error);\n    }\n  },\n  mounted() {\n    // player를 초기화합니다.\n    this.initPlayer();\n    window.addEventListener(\"keyupEvent\", this.handleKeydown);\n  },\n  watch: {\n    \"videoOptions.sources\": {\n      handler(newSources) {\n        const newSrc = newSources[0].src;\n        if (newSrc) {\n          if (this.player) {\n            this.player.src(newSrc);\n          } else {\n            this.initPlayer();\n          }\n        }\n      },\n      deep: true, // 깊은 변경 감지\n    },\n  },\n  methods: {\n    async getLectureDetail() {\n      console.log(\"강의 불러오기\");\n      try {\n        const response = await axios.get(\n          `${process.env.VUE_APP_API_BASE_URL}/user/lecture/detail/${this.lectureId}`\n        );\n        const additionalData = response.data.result;\n        this.lectureData = additionalData;\n\n        // 시간용 변수 적용\n        this.mostWatchedTime = this.lectureData.userLectureDuration;\n        if (this.lectureData.isCompleted) {\n          this.currentVideoTime = 0; //이미 시청이 완료된 경우는처음부터 다시 시청\n        } else {\n          this.currentVideoTime = this.lectureData.userLectureDuration;\n        }\n        this.updateUserProgress(); // 유저 표시용도의 퍼센트 계산\n\n        // lectureData에서 videoUrl을 가져와 videoOptions를 업데이트합니다.\n        this.videoOptions.sources[0].src = this.lectureData.videoUrl;\n      } catch (e) {\n        if (e.response.data.status_code === 404) {\n          alert(\"수강신청이 되지 않았습니다.\");\n          history.go(-1);\n        } else {\n          console.error(e);\n        }\n      }\n    },\n    setLectureDetail() {\n      // videoOptions가 업데이트된 후 loadVideo를 true로 설정하여 VideoPlayer를 렌더링합니다.\n      this.loadVideo = true;\n    },\n    initPlayer() {\n      if (this.videoOptions.sources[0].src) {\n        this.player = videojs(this.$refs.videoPlayer, this.videoOptions, () => {\n          // 영상 시작 시간을 설정하는 이벤트\n          this.player.on(\"loadstart\", () => {\n            this.setStartTime();\n          });\n\n          // 영상이 시작될 때\n          this.player.on(\"play\", () => {\n            this.onVideoPlay();\n          });\n\n          // 영상이 일시정지될 때\n          this.player.on(\"pause\", () => {\n            this.onVideoPause();\n          });\n\n          // 영상이 끝날 때\n          this.player.on(\"ended\", () => {\n            this.onVideoEnded();\n          });\n        });\n      }\n    },\n    setStartTime() {\n      // 영상의 시작 시간을 설정\n      this.player.currentTime(this.currentVideoTime);\n      console.log(\"영상의 시작 시간이 설정되었습니다.\");\n    },\n    onVideoPlay() {\n      console.log(\"영상이 시작되었습니다.\");\n\n      if (!this.lectureData.isCompleted) {\n        //시청 완료가 false인 경우만 check 시작\n        this.checkInterval = setInterval(() => {\n          // 3초마다 플레이된 시간 체크 시작\n          this.checkPlayTime();\n        }, 3000);\n\n        this.updateUserProgressInterval = setInterval(() => {\n          this.updateUserProgress();\n        }, 1000);\n      }\n    },\n    onVideoPause() {\n      console.log(\"영상이 일시정지되었습니다.\");\n      // 3초마다 플레이된 시간 체크 중지\n      if (this.checkInterval) {\n        clearInterval(this.checkInterval);\n        this.checkInterval = null;\n      }\n\n      // 퍼센트 계산하던 것 체크 중지\n      if (this.updateUserProgressInterval) {\n        clearInterval(this.updateUserProgressInterval);\n        this.updateUserProgressInterval = null;\n      }\n    },\n    onVideoEnded() {\n      console.log(\"영상이 끝났습니다.\");\n      \n\n      if (!this.lectureData.isCompleted) {\n        //기존에 시청완료가 되지 않았던 것만 보냄\n        this.currentVideoTime = this.lectureData.videoDuration\n        this.updateUserProgress(); //완료된 것을 통해 100%로 다시 진행률 업데이트\n        this.postUserVideoEndedStatus(); // 비디오 끝 함수 호츨\n      }\n      clearInterval(this.checkInterval); // 영상이 끝나면 인터벌을 정리합니다.\n      clearInterval(this.updateUserProgressInterval); // 영상이 끝나면 인터벌을 정리합니다.\n    },\n    checkPlayTime() {\n      this.currentVideoTime = Math.floor(this.player.currentTime()); // 소수점 내림으로 고정. (비디오 전체시간때문에!)\n      this.postUserDurationVideoTime();\n      console.log(\"현재 플레이된 시간: \", this.currentVideoTime, \"초\");\n    },\n    updateUserProgress() {\n      let progressTime = this.currentVideoTime;\n      if (this.currentVideoTime <= this.mostWatchedTime) {\n        progressTime = this.mostWatchedTime;\n      }\n      const percentage = (progressTime / this.lectureData.videoDuration) * 100; //현재 시간을 기준으로 퍼센트 계산\n      let roundPercent = Math.round(percentage * 10) / 10; // 소수점 첫 번째 자리까지만 존재하도록 반올림\n      roundPercent =\n        roundPercent >= 100 && !this.lectureData.isCompleted\n          ? 99\n          : roundPercent >= 100\n          ? 100\n          : roundPercent; // isCompleted true 여야 100\n      this.userProgress = roundPercent;\n    },\n\n    async postUserDurationVideoTime() {\n      if (this.currentVideoTime >= this.mostWatchedTime) {\n        try {\n          const userLectureDuration = {\n            userLectureDuration: this.currentVideoTime,\n          };\n          const response = await axios.patch(\n            `${process.env.VUE_APP_API_BASE_URL}/enroll/update/duration/${this.lectureData.enrollmentId}`,\n            userLectureDuration\n          );\n          console.log(\"update response:\", response); // error 해결용 log 추가\n        } catch (e) {\n          if (e.response.data.status_code === 404) {\n            alert(e.response.data.status_code.e.response.data.status_message);\n            history.go(-1);\n          } else {\n            alert(e.response.data.status_code.e.response.data.status_message);\n            console.error(e);\n          }\n        }\n      }\n    },\n    async postUserVideoEndedStatus() {\n      if (this.currentVideoTime > this.lectureData.videoDuration) {\n        this.currentVideoTime = this.lectureData.videoDuration; // 더 큰값이 들어가면 초기화\n      }\n      try {\n        const isCompleted = {\n          isCompleted: true,\n        };\n        const response = await axios.patch(\n          `${process.env.VUE_APP_API_BASE_URL}/enroll/update/complete/${this.lectureData.enrollmentId}`,\n          isCompleted\n        );\n        console.log(\"update response:\", response); // error 해결용 log 추가\n        this.lectureData.isCompleted = true;\n        this.updateUserProgress();\n      } catch (e) {\n        if (e.response.data.status_code === 404) {\n          alert(e.response.data.status_code.e.response.data.status_message);\n          history.go(-1);\n        } else {\n          alert(e.response.data.status_code.e.response.data.status_message);\n          console.error(e);\n        }\n      }\n    },\n    keyupEvent(event) {\n      // 오른쪽 방향키 (Key code: 39)\n      if (event.key === 'ArrowRight') {\n        this.skip(5);\n      }\n\n      // 왼쪽 방향키 (Key code: 37)\n      else if (event.key === 'ArrowLeft') {\n        this.skip(-5);\n      }\n\n      // 스페이스바 (Key code: 32)\n      else if (event.key === ' ') {\n        if (this.player.paused()) {\n          this.player.play();\n        } else {\n          this.player.pause();\n        }\n      }\n    },\n    skip(seconds) {\n      let currentTime = this.player.currentTime();\n      let newTime = currentTime + seconds;\n\n      if (newTime < 0) newTime = 0;\n      if (newTime > this.player.duration()) newTime = this.player.duration();\n\n      this.player.currentTime(newTime);\n    },\n  },\n  beforeUnmount() {\n    if (this.player) {\n      this.player.dispose();\n    }\n\n    if (this.checkInterval) {\n      clearInterval(this.checkInterval);\n    }\n\n    if (this.updateUserProgressInterval) {\n      clearInterval(this.updateUserProgressInterval);\n    }\n    window.removeEventListener(\"keyupEvent\", this.handleKeydown);\n  },\n};\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}